<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product | SUMWON</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <style>
    .product-detail { max-width: 540px; margin: 0 auto; background: #fff; border-radius: 16px; box-shadow: 0 2px 16px rgba(0,0,0,0.07); padding: 0 0 1.5em 0; }
    .product-gallery { width: 100%; position: relative; text-align: center; }
    .product-gallery img { width: 100%; max-width: 420px; border-radius: 0 0 16px 16px; }
    .product-gallery-dots { display: flex; justify-content: center; gap: 7px; margin: 0.5em 0; }
    .product-gallery-dot { width: 8px; height: 8px; border-radius: 50%; background: #bbb; border: none; }
    .product-gallery-dot.active { background: #222; }
    .product-info { padding: 1.1em 1.2em 0 1.2em; }
    .product-price { display: flex; align-items: center; gap: 0.7em; font-size: 1.3em; margin-bottom: 0.2em; }
    .current-price { color: #e53935; font-weight: bold; font-size: 1.3em; }
    .old-price { color: #888; text-decoration: line-through; font-size: 1em; }
    .discount { color: #e53935; background: #fff0f0; border: 1px solid #e53935; border-radius: 5px; font-size: 0.95em; padding: 2px 7px; font-weight: 600; }
    .product-title { font-size: 1.15em; font-weight: 700; margin: 0.2em 0 0.3em 0; }
    .product-rating { color: #ffb400; font-size: 1.1em; margin-right: 0.3em; }
    .product-reviews { color: #888; font-size: 0.98em; margin-left: 0.2em; }
    .product-swatches { display: flex; flex-wrap: wrap; gap: 0.5em; margin: 0.7em 0 1em 0; }
    .swatch { position: relative; width: 32px; height: 32px; border-radius: 50%; border: 2px solid #eee; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: border 0.2s; }
    .swatch.selected { border: 2.5px solid #e53935; }
    .swatch-discount { position: absolute; top: -13px; left: 50%; transform: translateX(-50%); background: #fff; color: #e53935; border: 1px solid #e53935; border-radius: 4px; font-size: 0.8em; padding: 0 4px; font-weight: 600; }
    .swatch-inner { width: 22px; height: 22px; border-radius: 50%; border: 1.5px solid #ccc; }
    .product-options { margin-bottom: 1.1em; }
    .product-sizes { display: flex; flex-wrap: wrap; gap: 0.5em; margin: 0.7em 0 1.2em 0; }
    .size-btn { padding: 0.5em 1.2em; border-radius: 7px; border: 1.5px solid #eee; background: #fafafa; font-size: 1em; font-weight: 600; cursor: pointer; transition: border 0.2s, background 0.2s; }
    .size-btn.selected { border: 2px solid #222; background: #e6e6e6; }
    .size-btn[disabled] { color: #aaa; border: 1.5px dashed #ddd; background: #f5f5f5; cursor: not-allowed; }
    .add-to-cart-bar { position: fixed; left: 0; right: 0; bottom: 0; background: #18191a; color: #fff; z-index: 100; display: flex; align-items: center; justify-content: center; padding: 1em 0.5em; box-shadow: 0 -2px 16px rgba(0,0,0,0.10); }
    .add-to-cart-bar .add-to-cart-btn { background: #fff; color: #18191a; font-weight: 700; border: none; border-radius: 8px; padding: 0.7em 2.2em; font-size: 1.1em; cursor: pointer; margin-left: 1em; }
    .signup-offer { position: fixed; left: 50%; bottom: 70px; transform: translateX(-50%); background: #fff; color: #222; border-radius: 12px; box-shadow: 0 2px 16px rgba(0,0,0,0.13); padding: 1em 1.5em; z-index: 101; display: flex; align-items: center; gap: 1em; }
    .signup-offer .close-signup { background: none; border: none; font-size: 1.5em; color: #888; cursor: pointer; margin-left: 1em; }
    @media (max-width: 600px) {
      .product-detail { border-radius: 0; box-shadow: none; }
      .product-info { padding: 0.7em 0.5em 0 0.5em; }
      .add-to-cart-bar { font-size: 0.98em; padding: 0.7em 0.2em; }
      .signup-offer { padding: 0.7em 0.7em; font-size: 0.98em; }
    }
  </style>
</head>
<body>
  <header>
    <nav class="navbar-flex">
      <button class="menu-btn" id="openSidebar" aria-label="Open menu">
        <span></span><span></span><span></span>
      </button>
      <div class="brand-logo-wrap">
        <div class="logo">
          <div class="logo-icon">
            <svg width="64" height="64" viewBox="0 0 64 64">
              <path class="logo-arc-top" d="M 14 29 a 20 20 0 1 1 40 0" stroke="#221C19" stroke-width="6" fill="none" stroke-linecap="butt" />
              <path class="logo-arc-bottom" d="M 14 35 a 20.5 21 0 0 0  40 0" stroke="#221C19" stroke-width="6" fill="none" stroke-linecap="butt" />
              <line class="logo-vert" x1="32" y1="12" x2="32" y2="52" stroke="#221C19" stroke-width="6" stroke-linecap="butt" />
              <line class="logo-horiz" x1="32" y1="32" x2="52" y2="32" stroke="#221C19" stroke-width="6" stroke-linecap="butt" />
            </svg>
          </div>
        </div>
        <span class="brand-name">Code Studios</span>
      </div>
      <div class="search-box-wrap">
        <input type="text" class="search-input-box" id="searchInputBox" placeholder="Search products..." style="display:none;">
        <div class="search-suggestions" id="searchSuggestions" style="display:none;"></div>
      </div>
      <button class="search-btn" aria-label="Search">
        <svg class="search-icon" width="38" height="38" viewBox="0 0 24 24" fill="none" stroke="#221C19" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="7" />
          <line x1="18" y1="18" x2="15.5" y2="15.5" />
        </svg>
      </button>
    </nav>
  </header>
  <aside class="sidebar" id="sidebar">
    <button class="close-btn" id="closeSidebar" aria-label="Close menu">&times;</button>
    <ul class="sidebar-links">
      <li><a href="#">Home</a></li>
      <li><a href="#">Cart</a></li>
      <li><a href="#">Me</a></li>
    </ul>
  </aside>
  <main>
    <section class="product-detail" id="productDetail">
      <div class="loading">Loading...</div>
    </section>
    <div class="signup-offer" id="signupOffer">
      <span>üéÅ <b>SIGN UP FOR 15% OFF</b></span>
      <button class="close-signup" onclick="document.getElementById('signupOffer').style.display='none'">&times;</button>
    </div>
    <div class="add-to-cart-bar" id="addToCartBar" style="display:none">
      <span id="cartBarPrice"></span>
      <button class="add-to-cart-btn">ADD TO CART</button>
    </div>
  </main>
  <footer>
    <section class="subscribe">
      <h3>Join our mailing list</h3>
      <form>
        <input type="email" placeholder="Your Email" required>
        <button type="submit">Subscribe</button>
      </form>
      <p class="terms">By continuing, you agree to our <a href="#">Terms Of Use</a> and <a href="#">Privacy & Cookie Policy</a>.</p>
    </section>
    <ul class="footer-links">
      <li><a href="#">Shipping Info</a></li>
      <li><a href="#">Terms & Conditions</a></li>
      <li><a href="#">Privacy Policy</a></li>
      <li><a href="#">Return Policy</a></li>
      <li><a href="#">Contact Us</a></li>
    </ul>
    <p>¬© 2025 Sumwon-ALL RIGHTS RESERVED</p>
  </footer>
  <script src="script.js"></script>
  <script>
    function getProducts() {
      const data = localStorage.getItem('products');
      if (!data) return [];
      return JSON.parse(data);
    }

    function generateProductId() {
      return 'prod_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }

    function migrateExistingProducts() {
      const products = getProducts();
      let needsUpdate = false;
      products.forEach(product => {
        if (!product.id) {
          product.id = generateProductId();
          needsUpdate = true;
        }
      });
      if (needsUpdate) {
        localStorage.setItem('products', JSON.stringify(products));
      }
    }

    function addDemoProducts() {
      const products = getProducts();
      if (products.length === 0) {
        const demoProducts = [
          {
            id: generateProductId(),
            name: "Classic White T-Shirt",
            price: 45.00,
            oldPrice: 65.00,
            description: "Premium cotton classic white t-shirt with comfortable fit.",
            colors: ["#ffffff", "#000000", "#808080"],
            quantity: 25,
            category: "tshirt",
            rating: 4.5,
            photos: ["https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&fit=crop&w=400&q=80"]
          },
          {
            id: generateProductId(),
            name: "Oversized Black Tee",
            price: 55.00,
            oldPrice: 75.00,
            description: "Trendy oversized black t-shirt perfect for casual wear.",
            colors: ["#000000", "#333333"],
            quantity: 18,
            category: "tshirt",
            rating: 4.8,
            photos: ["https://images.unsplash.com/photo-1503341504253-dff4815485f1?auto=format&fit=crop&w=400&q=80"]
          },
          {
            id: generateProductId(),
            name: "Striped Summer Tee",
            price: 35.00,
            description: "Lightweight striped t-shirt perfect for summer days.",
            colors: ["#0000ff", "#ff0000", "#00ff00"],
            quantity: 30,
            category: "tshirt",
            rating: 4.2,
            photos: ["https://images.unsplash.com/photo-1434389677669-e08b4cac3105?auto=format&fit=crop&w=400&q=80"]
          },
          {
            id: generateProductId(),
            name: "Premium Cotton V-Neck",
            price: 65.00,
            oldPrice: 85.00,
            description: "High-quality cotton v-neck t-shirt with elegant design.",
            colors: ["#ffffff", "#000000", "#8B4513"],
            quantity: 15,
            category: "tshirt",
            rating: 4.7,
            photos: ["https://images.unsplash.com/photo-1581655353564-df123a1eb820?auto=format&fit=crop&w=400&q=80"]
          }
        ];
        localStorage.setItem('products', JSON.stringify(demoProducts));
      }
    }

    function calcDiscount(price, oldPrice) {
      if (!oldPrice || !price) return null;
      return Math.round(100 - (price / oldPrice) * 100);
    }

    function loadProduct() {
      migrateExistingProducts(); // Ensure all products have IDs
      addDemoProducts(); // Add demo products if none exist
      
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id');
      const detail = document.getElementById('productDetail');
      
      if (!id) {
        detail.innerHTML = '<div class="error">Product not found.</div>';
        return;
      }

      const products = getProducts();
      const product = products.find(p => p.id === id);
      
      if (!product) {
        detail.innerHTML = '<div class="error">Product not found.</div>';
        return;
      }

      // –ì–∞–ª–µ—Ä–µ—è
      let gallery = '';
      if (product.photos && product.photos.length > 0) {
        gallery = `<div class='product-gallery'><img id='mainImg' src='${product.photos[0]}' alt='${product.name}' />`;
        if (product.photos.length > 1) {
          gallery += `<div class='product-gallery-dots'>`;
          for (let i = 0; i < product.photos.length; i++) {
            gallery += `<button class='product-gallery-dot' data-idx='${i}'${i===0?' active':''}></button>`;
          }
          gallery += `</div>`;
        }
        gallery += `</div>`;
      }

      // –¶–≤–µ—Ç–∞
      let swatches = '';
      if (product.colors && product.colors.length > 0) {
        swatches = `<div class='product-swatches'>`;
        for (let i = 0; i < product.colors.length; i++) {
          const color = product.colors[i];
          swatches += `<div class='swatch' data-color='${i}' title='Color ${i+1}'>
            <span class='swatch-inner' style='background:${color}'></span>
          </div>`;
        }
        swatches += `</div>`;
      }

      // –†–∞–∑–º–µ—Ä—ã (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã)
      let sizes = '';
      const standardSizes = ['XS', 'S', 'M', 'L', 'XL', 'XXL'];
      sizes = `<div class='product-sizes'>`;
      for (let size of standardSizes) {
        const available = product.quantity > 0;
        sizes += `<button class='size-btn'${!available?' disabled':''}>${size}</button>`;
      }
      sizes += `</div>`;

      // –†–µ–π—Ç–∏–Ω–≥ –∏ –æ—Ç–∑—ã–≤—ã
      let reviews = `<div style='margin:0.5em 0 1em 0;'>`;
      if (product.rating) {
        reviews += `<span class='product-rating'>${'‚òÖ'.repeat(Math.floor(product.rating))}${'‚òÜ'.repeat(5-Math.floor(product.rating))}</span> <span class='product-reviews'>${product.rating} RATING</span>`;
      } else {
        reviews += `<span class='product-rating'>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span> <span class='product-reviews'>NEW PRODUCT</span>`;
      }
      reviews += `</div>`;

      // –°–∫–∏–¥–∫–∞
      const discount = (product.oldPrice && product.price) ? calcDiscount(product.price, product.oldPrice) : null;

      // –ò—Ç–æ–≥–æ–≤–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞
      detail.innerHTML = `
        ${gallery}
        <div class='product-info'>
          <div class='product-price'>
            <span class='current-price'>${product.price} AED</span>
            ${product.oldPrice ? `<span class='old-price'>${product.oldPrice} AED</span>` : ''}
            ${discount ? `<span class='discount'>-${discount}%</span>` : ''}
          </div>
          <div class='product-title'>${product.name}</div>
          ${reviews}
          ${product.colors && product.colors.length > 0 ? `<div class='product-options'><b>COLOR:</b> <span id='colorName'>Color 1</span></div>` : ''}
          ${swatches}
          <div class='product-options'><b>SIZE:</b></div>
          ${sizes}
          <div class='product-description'><p>${product.description || 'No description available.'}</p></div>
          <div style='margin-top:1em;color:#888;font-size:0.9em;'>Stock: ${product.quantity} units</div>
        </div>
      `;

      // –ì–∞–ª–µ—Ä–µ—è dots
      if (product.photos && product.photos.length > 1) {
        const mainImg = document.getElementById('mainImg');
        document.querySelectorAll('.product-gallery-dot').forEach(dot => {
          dot.addEventListener('click', function() {
            const idx = +this.getAttribute('data-idx');
            mainImg.src = product.photos[idx];
            document.querySelectorAll('.product-gallery-dot').forEach(d => d.classList.remove('active'));
            this.classList.add('active');
          });
        });
      }

      // Swatch –≤—ã–±–æ—Ä —Ü–≤–µ—Ç–∞
      if (product.colors && product.colors.length > 0) {
        let selectedColorIndex = 0;
        document.querySelectorAll('.swatch').forEach((sw, i) => {
          if (i === 0) sw.classList.add('selected');
          sw.addEventListener('click', function() {
            document.querySelectorAll('.swatch').forEach(s => s.classList.remove('selected'));
            this.classList.add('selected');
            selectedColorIndex = i;
            document.getElementById('colorName').textContent = `Color ${i+1}`;
          });
        });
      }

      // Size –≤—ã–±–æ—Ä
      let selectedSize = null;
      document.querySelectorAll('.size-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          if (this.disabled) return;
          document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('selected'));
          this.classList.add('selected');
          selectedSize = this.textContent;
        });
      });

      // Add to cart bar
      const cartBar = document.getElementById('addToCartBar');
      const cartBarPrice = document.getElementById('cartBarPrice');
      cartBarPrice.textContent = `${product.price} AED`;
      cartBar.style.display = 'flex';
    }
    
    loadProduct();
  </script>
</body>
</html> 