<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shorts | Code Studios</title>
  <link rel="stylesheet" href="../style.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <nav class="navbar-flex">
      <button class="menu-btn" id="openSidebar" aria-label="Open menu">
        <span></span><span></span><span></span>
      </button>
      <div class="brand-logo-wrap">
        <div class="logo">
          <div class="logo-icon">
            <svg width="64" height="64" viewBox="0 0 64 64">
              <path class="logo-arc-top" d="M 14 29 a 20 20 0 1 1 40 0" stroke="#fff" stroke-width="6" fill="none" stroke-linecap="butt" />
              <path class="logo-arc-bottom" d="M 14 35 a 20.5 21 0 0 0  40 0" stroke="#fff" stroke-width="6" fill="none" stroke-linecap="butt" />
              <line class="logo-vert" x1="32" y1="12" x2="32" y2="52" stroke="#fff" stroke-width="6" stroke-linecap="butt" />
              <line class="logo-horiz" x1="32" y1="32" x2="52" y2="32" stroke="#fff" stroke-width="6" stroke-linecap="butt" />
            </svg>
          </div>
        </div>
        <span class="brand-name">Code Studios</span>
      </div>
      <div class="search-box-wrap">
        <button class="search-btn" aria-label="Search">
          <svg class="search-icon" width="22" height="22" viewBox="0 0 22 22" fill="none" stroke="#222" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="10" cy="10" r="7"/><line x1="15.5" y1="15.5" x2="20" y2="20"/></svg>
        </button>
        <input type="text" class="search-input-box" id="searchInputBox" placeholder="Search products..." style="display:none;">
        <div class="search-suggestions" id="searchSuggestions" style="display:none;"></div>
      </div>
    </nav>
  </header>
  <main class="main-container">
    <section class="promo-slider-section">
      <div class="promo-slider" id="promoSlider">
        <div class="promo-slide active" data-bg="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80">
          <div class="promo-slide-overlay"></div>
          <div class="promo-slide-info">
            <h3 class="promo-slide-title">🔥 Summer Sale: Casual Shorts</h3>
            <div class="promo-slide-prices">
              <span class="promo-slide-price">49.99 AED</span>
              <span class="promo-slide-old-price">79.99 AED</span>
            </div>
            <div class="promo-slide-desc">Only this week! Limited stock.</div>
            <div class="promo-slide-timer" data-deadline="2024-07-10T23:59:59"></div>
            <a href="#" class="promo-slide-btn">Shop Now</a>
          </div>
        </div>
        <div class="promo-slide" data-bg="https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=800&q=80">
          <div class="promo-slide-overlay"></div>
          <div class="promo-slide-info">
            <h3 class="promo-slide-title">🔥 Bestseller: Sport Shorts</h3>
            <div class="promo-slide-prices">
              <span class="promo-slide-price">54.50 AED</span>
              <span class="promo-slide-old-price">89.00 AED</span>
            </div>
            <div class="promo-slide-desc">Hurry up! Sale ends soon.</div>
            <div class="promo-slide-timer" data-deadline="2024-07-12T23:59:59"></div>
            <a href="#" class="promo-slide-btn">Shop Now</a>
          </div>
        </div>
        <div class="promo-slide" data-bg="https://images.unsplash.com/photo-1469398715555-76331a6c7c9b?auto=format&fit=crop&w=800&q=80">
          <div class="promo-slide-overlay"></div>
          <div class="promo-slide-info">
            <h3 class="promo-slide-title">🔥 Limited Edition: Premium Shorts</h3>
            <div class="promo-slide-prices">
              <span class="promo-slide-price">64.90 AED</span>
              <span class="promo-slide-old-price">99.00 AED</span>
            </div>
            <div class="promo-slide-desc">Exclusive offer! Don't miss out.</div>
            <div class="promo-slide-timer" data-deadline="2024-07-15T23:59:59"></div>
            <a href="#" class="promo-slide-btn">Shop Now</a>
          </div>
        </div>
        <div class="promo-slider-dots" id="promoSliderDots"></div>
      </div>
    </section>
    <section class="category-section">
      <h2>Shorts</h2>
      <div class="product-toolbar">
        <div class="toolbar-left">
          <span class="toolbar-sort-label">Sort <span class="toolbar-caret">▼</span></span>
          <span class="toolbar-sort-active">Most Popular</span>
          <span class="toolbar-price">Price <span class="toolbar-price-arrows">⇅</span></span>
        </div>
        <div class="toolbar-right">
          <span class="toolbar-filter">Filter
            <svg class="toolbar-filter-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="#222" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <line x1="3" y1="5" x2="17" y2="5" />
              <line x1="6" y1="10" x2="14" y2="10" />
              <line x1="9" y1="15" x2="11" y2="15" />
            </svg>
          </span>
        </div>
      </div>
      <div class="product-grid" id="shortsProductGrid"></div>
    </section>
    <div class="filter-modal" id="filterModal" style="display:none;">
      <div class="filter-modal-content">
        <h3>Filter by color</h3>
        <form id="filterColorsForm">
          <label><input type="checkbox" value="#222"> <span class="color-dot" style="background:#222"></span> Black</label><br>
          <label><input type="checkbox" value="#fff"> <span class="color-dot" style="background:#fff; border:1px solid #ccc"></span> White</label><br>
          <label><input type="checkbox" value="#bfae9e"> <span class="color-dot" style="background:#bfae9e"></span> Beige</label><br>
          <label><input type="checkbox" value="#a7b1b7"> <span class="color-dot" style="background:#a7b1b7"></span> Blue Gray</label><br>
          <label><input type="checkbox" value="#c7b7a3"> <span class="color-dot" style="background:#c7b7a3"></span> Sand</label><br>
          <label><input type="checkbox" value="#eee"> <span class="color-dot" style="background:#eee; border:1px solid #ccc"></span> Light Gray</label><br>
        </form>
        <button id="applyFilterBtn">Apply</button>
        <button id="resetFilterBtn" type="button">Reset</button>
        <button id="closeFilterBtn" type="button">Close</button>
      </div>
    </div>
    <aside class="sidebar" id="sidebar">
      <button class="close-btn" id="closeSidebar" aria-label="Close menu">&times;</button>
      <ul class="sidebar-links">
        <li><a href="../index.html">Home</a></li>
        <li><a href="../dashboard/dash.html">Dashboard</a></li>
        <li><a href="#">Cart</a></li>
        <li><a href="#">Me</a></li>
        <li class="theme-toggle">
          <button id="themeToggle" style="background:none;border:none;color:inherit;font-size:1.2em;padding:0.5em 1em;display:block;width:100%;text-align:left;cursor:pointer;">
            🌙 Dark Mode
          </button>
        </li>
      </ul>
    </aside>
  </main>
  <footer>
    <section class="subscribe">
      <h3>Join our mailing list</h3>
      <form>
        <input type="email" placeholder="Your Email" required>
        <button type="submit">Subscribe</button>
      </form>
      <p class="terms">By continuing, you agree to our <a href="#">Terms Of Use</a> and <a href="#">Privacy & Cookie Policy</a>.</p>
    </section>
    <ul class="footer-links">
      <li><a href="#">Shipping Info</a></li>
      <li><a href="#">Terms & Conditions</a></li>
      <li><a href="#">Privacy Policy</a></li>
      <li><a href="#">Return Policy</a></li>
      <li><a href="#">Contact Us</a></li>
    </ul>
    <p>© 2025 Code Studios - ALL RIGHTS RESERVED</p>
  </footer>
  <script src="../script.js"></script>
  <script>
document.addEventListener('DOMContentLoaded', function() {
  function getProducts() {
    const data = localStorage.getItem('products');
    if (!data) return [];
    return JSON.parse(data);
  }
  function generateProductId() {
    return 'prod_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
  }
  function migrateExistingProducts() {
    const products = getProducts();
    let needsUpdate = false;
    products.forEach(product => {
      if (!product.id) {
        product.id = generateProductId();
        needsUpdate = true;
      }
    });
    if (needsUpdate) {
      localStorage.setItem('products', JSON.stringify(products));
    }
  }

  function addDemoProducts() {
    const products = getProducts();
    if (products.length === 0) {
      const demoProducts = [
        {
          id: generateProductId(),
          name: "Casual Summer Shorts",
          price: 49.99,
          oldPrice: 79.99,
          description: "Comfortable summer shorts for casual wear.",
          colors: ["#ffffff", "#000000", "#808080"],
          quantity: 35,
          category: "shorts",
          rating: 4.3,
          photos: ["https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80"]
        }
      ];
      localStorage.setItem('products', JSON.stringify(demoProducts));
    }
  }
  function calcDiscount(price, oldPrice) {
    if (!oldPrice || !price) return null;
    return Math.round(100 - (price / oldPrice) * 100);
  }
  function renderShortsProducts() {
    const grid = document.getElementById('shortsProductGrid');
    if (!grid) return;
    const products = getProducts().filter(p => p.category === 'shorts');
    if (products.length === 0) {
      grid.innerHTML = '<div style="padding:2em;">No Shorts found.</div>';
      return;
    }
    grid.innerHTML = products.map(product => {
      const discount = (product.oldPrice && product.price) ? calcDiscount(product.price, product.oldPrice) : null;
      return `
      <div class="product-card" style="background:#fff;border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,0.07);padding:0.8em 0.8em 1em 0.8em;display:flex;flex-direction:column;align-items:center;position:relative;max-width:280px;margin:0 auto 1.5em auto;cursor:pointer;" onclick="window.location.href='../product.html?id=${product.id}'">
        <div class="product-image-wrap" style="width:100%;display:flex;justify-content:center;align-items:center;gap:4px;position:relative;">
          ${discount ? `<div style='position:absolute;left:8px;top:8px;background:#f66;color:#fff;font-size:0.9em;padding:2px 8px;border-radius:6px;z-index:3;'>-${discount}%</div>` : ''}
          ${product.photos && product.photos[0] ? `<img src="${product.photos[0]}" alt="product" style="width:100%;max-width:200px;max-height:200px;border-radius:8px;object-fit:cover;position:relative;z-index:1;">` : ''}
          <button class="product-fav" aria-label="Add to favorites" style="position:absolute;right:12px;top:8px;background:#fff;border-radius:50%;border:none;width:28px;height:28px;box-shadow:0 2px 8px rgba(0,0,0,0.07);font-size:1.1em;cursor:pointer;z-index:3;" onclick="event.stopPropagation();">&#9825;</button>
        </div>
        <div class="product-info" style="width:100%;margin-top:0.8em;">
          <div class="product-title" style="font-size:1em;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${product.name}</div>
          <div class="product-price-row" style="margin:0.4em 0;display:flex;align-items:center;gap:8px;justify-content:space-between;">
            <span style="display:flex;align-items:center;gap:8px;">
              <span class="product-price" style="font-size:1.1em;font-weight:700;color:#d33;">${product.price} AED</span>
              ${product.oldPrice ? `<span class="product-old-price" style="text-decoration:line-through;color:#888;font-size:0.9em;">${product.oldPrice} AED</span>` : ''}
            </span>
            ${product.rating ? `<span class="product-rating" style="color:#f90;font-weight:600;font-size:0.9em;">${product.rating} &#9733;</span>` : ''}
          </div>
          <div class="product-colors" style="margin-bottom:0.4em;">
            ${(product.colors||[]).map(c=>`<span class='color-dot' style='display:inline-block;width:16px;height:16px;border-radius:50%;background:${c};margin:0 2px;border:1.5px solid #ccc;vertical-align:middle;'></span>`).join('')}
          </div>
          <div class="product-meta" style="display:flex;align-items:center;gap:8px;">
            <span class="product-qty" style="color:#888;font-size:0.9em;">Stock: ${product.quantity}</span>
            <button class="product-cart" aria-label="Add to cart" style="background:#fff;border-radius:50%;border:1.5px solid #eee;width:28px;height:28px;box-shadow:0 2px 8px rgba(0,0,0,0.07);font-size:1.1em;cursor:pointer;" onclick="event.stopPropagation();">&#128722;</button>
          </div>
        </div>
      </div>
    `}).join('');
  }

  // Search functionality
  const searchBtn = document.querySelector('.search-btn');
  const searchInput = document.getElementById('searchInputBox');
  const searchSuggestions = document.getElementById('searchSuggestions');
  const searchBoxWrap = document.querySelector('.search-box-wrap');

  function showSearchInput() {
    if (searchInput) {
      searchInput.style.display = 'block';
      searchInput.value = '';
      searchInput.focus();
    }
    if (searchSuggestions) {
      searchSuggestions.style.display = 'none';
      searchSuggestions.innerHTML = '';
    }
    if (searchBtn) searchBtn.style.display = 'none';
  }

  function hideSearchInput() {
    if (searchInput) searchInput.style.display = 'none';
    if (searchSuggestions) {
      searchSuggestions.style.display = 'none';
      searchSuggestions.innerHTML = '';
    }
    if (searchBtn) searchBtn.style.display = 'block';
    // Reset search and show all products
    renderShortsProducts();
  }

  if (searchBtn && searchInput) {
    searchBtn.addEventListener('click', showSearchInput);
  }

  // Close search when clicking outside
  document.addEventListener('mousedown', function(e) {
    if (searchInput && searchInput.style.display === 'block') {
      if (!searchBoxWrap.contains(e.target)) {
        hideSearchInput();
      }
    }
  });

  // Close search on Escape key
  if (searchInput) {
    searchInput.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') hideSearchInput();
    });
  }

  // Search functionality
  if (searchInput) {
    searchInput.addEventListener('input', function() {
      const query = searchInput.value.trim().toLowerCase();
      const grid = document.getElementById('shortsProductGrid');
      if (!grid) return;

      if (!query) {
        renderShortsProducts();
        return;
      }

      const products = getProducts().filter(p => p.category === 'shorts');
      const filteredProducts = products.filter(product => 
        product.name.toLowerCase().includes(query)
      );

      if (filteredProducts.length === 0) {
        grid.innerHTML = '<div style="padding:2em;text-align:center;">No Shorts found matching "' + query + '".</div>';
        return;
      }

      grid.innerHTML = filteredProducts.map(product => {
        const discount = (product.oldPrice && product.price) ? calcDiscount(product.price, product.oldPrice) : null;
        return `
        <div class="product-card" style="background:#fff;border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,0.07);padding:0.8em 0.8em 1em 0.8em;display:flex;flex-direction:column;align-items:center;position:relative;max-width:280px;margin:0 auto 1.5em auto;cursor:pointer;" onclick="window.location.href='../product.html?id=${product.id}'">
          <div class="product-image-wrap" style="width:100%;display:flex;justify-content:center;align-items:center;gap:4px;position:relative;">
            ${discount ? `<div style='position:absolute;left:8px;top:8px;background:#f66;color:#fff;font-size:0.9em;padding:2px 8px;border-radius:6px;z-index:3;'>-${discount}%</div>` : ''}
            ${product.photos && product.photos[0] ? `<img src="${product.photos[0]}" alt="product" style="width:100%;max-width:200px;max-height:200px;border-radius:8px;object-fit:cover;position:relative;z-index:1;">` : ''}
            <button class="product-fav" aria-label="Add to favorites" style="position:absolute;right:12px;top:8px;background:#fff;border-radius:50%;border:none;width:28px;height:28px;box-shadow:0 2px 8px rgba(0,0,0,0.07);font-size:1.1em;cursor:pointer;z-index:3;" onclick="event.stopPropagation();">&#9825;</button>
          </div>
          <div class="product-info" style="width:100%;margin-top:0.8em;">
            <div class="product-title" style="font-size:1em;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${product.name}</div>
            <div class="product-price-row" style="margin:0.4em 0;display:flex;align-items:center;gap:8px;justify-content:space-between;">
              <span style="display:flex;align-items:center;gap:8px;">
                <span class="product-price" style="font-size:1.1em;font-weight:700;color:#d33;">${product.price} AED</span>
                ${product.oldPrice ? `<span class="product-old-price" style="text-decoration:line-through;color:#888;font-size:0.9em;">${product.oldPrice} AED</span>` : ''}
              </span>
              ${product.rating ? `<span class="product-rating" style="color:#f90;font-weight:600;font-size:0.9em;">${product.rating} &#9733;</span>` : ''}
            </div>
            <div class="product-colors" style="margin-bottom:0.4em;">
              ${(product.colors||[]).map(c=>`<span class='color-dot' style='display:inline-block;width:16px;height:16px;border-radius:50%;background:${c};margin:0 2px;border:1.5px solid #ccc;vertical-align:middle;'></span>`).join('')}
            </div>
            <div class="product-meta" style="display:flex;align-items:center;gap:8px;">
              <span class="product-qty" style="color:#888;font-size:0.9em;">Stock: ${product.quantity}</span>
              <button class="product-cart" aria-label="Add to cart" style="background:#fff;border-radius:50%;border:1.5px solid #eee;width:28px;height:28px;box-shadow:0 2px 8px rgba(0,0,0,0.07);font-size:1.1em;cursor:pointer;" onclick="event.stopPropagation();">&#128722;</button>
            </div>
          </div>
        </div>
      `}).join('');
    });
  }

  migrateExistingProducts(); // Call the migration function
  addDemoProducts(); // Call the demo products function
  renderShortsProducts();

  // Theme toggle functionality
  const themeToggle = document.getElementById('themeToggle');
  const body = document.body;
  
  function getTheme() {
    return localStorage.getItem('theme') || 'light';
  }
  
  function setTheme(theme) {
    localStorage.setItem('theme', theme);
    if (theme === 'dark') {
      body.classList.add('dark-theme');
      themeToggle.innerHTML = '☀️ Light Mode';
    } else {
      body.classList.remove('dark-theme');
      themeToggle.innerHTML = '🌙 Dark Mode';
    }
  }
  
  // Initialize theme
  setTheme(getTheme());
  
  // Theme toggle event
  if (themeToggle) {
    themeToggle.addEventListener('click', function() {
      const currentTheme = getTheme();
      setTheme(currentTheme === 'light' ? 'dark' : 'light');
    });
  }
});
  </script>
</body>
</html> 